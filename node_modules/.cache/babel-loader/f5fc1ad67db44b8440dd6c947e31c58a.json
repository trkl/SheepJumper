{"ast":null,"code":"import _classCallCheck from \"/Users/torkildjurhuus/Code/SheepJumper/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/torkildjurhuus/Code/SheepJumper/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nvar CollisionManger =\n/*#__PURE__*/\nfunction () {\n  function CollisionManger() {\n    var _this = this;\n\n    _classCallCheck(this, CollisionManger);\n\n    this.gameObjects = [undefined];\n\n    this.add = function (collisionZone) {\n      var i = -1;\n\n      while (_this.gameObjects[++i] !== undefined) {\n        _this.gameObjects[i] = collisionZone;\n        return i;\n      }\n\n      return _this.gameObjects.push(collisionZone) - 1;\n    };\n\n    this.remove = function (number) {\n      return _this.gameObjects[number] = undefined;\n    };\n\n    this.handleCollisions = function () {\n      var collisions = [];\n\n      for (var i = 0, length = _this.gameObjects.length; i < length; ++i) {\n        var obj1 = _this.gameObjects[i];\n        if (!obj1) continue;\n\n        for (var j = i + 1; j < length; ++j) {\n          var obj2 = _this.gameObjects[j];\n          if (!obj2) continue;\n\n          if (_this.collisionDetected(obj1, obj2)) {\n            if (obj1.collision.has(obj2)) continue;\n            collisions.push([{\n              object: obj1.props.parent,\n              collisionZone: obj2\n            }, {\n              object: obj2.props.parent,\n              collisionZone: obj1\n            }]);\n            obj1.collision.add(obj2);\n          } else {\n            if (obj1.collision.delete(obj2)) {\n              var gameObj1 = obj1.props.parent;\n              var gameObj2 = obj2.props.parent;\n              gameObj1.onCollisionEnd && gameObj1.onCollisionEnd({\n                object: gameObj2,\n                collisionZone: obj2\n              });\n              gameObj2.onCollisionEnd && gameObj2.onCollisionEnd({\n                object: gameObj1,\n                collisionZone: obj1\n              });\n            }\n          }\n        }\n      }\n\n      var _loop = function _loop() {\n        var collision = collisions[_i];\n        collision.forEach(function (element, idx) {\n          var object = element.object;\n          object.handleCollision && object.handleCollision(collision[Number(!idx)]);\n        });\n      };\n\n      for (var _i = 0; _i < collisions.length; _i++) {\n        _loop();\n      }\n    };\n  }\n\n  _createClass(CollisionManger, [{\n    key: \"collisionDetected\",\n    value: function collisionDetected(obj1, obj2) {\n      var position1 = obj1.position.plus(obj1.offset);\n      var position2 = obj2.position.plus(obj2.offset);\n      var bottomRight1 = position1.plus(obj1.dimensions);\n      var bottomRight2 = position2.plus(obj2.dimensions);\n      return position1.x < bottomRight2.x && bottomRight1.x > position2.x && position1.y < bottomRight2.y && bottomRight1.y > position2.y;\n    }\n  }], [{\n    key: \"instance\",\n    get: function get() {\n      if (CollisionManger._instance === null) CollisionManger._instance = new CollisionManger();\n      return CollisionManger._instance;\n    }\n  }]);\n\n  return CollisionManger;\n}(); // eslint-disable-next-line no-extend-native\n\n\nCollisionManger._instance = null;\nexport { CollisionManger as default };\n\nArray.prototype.filterInPlace = function (predicate) {\n  for (var i = 0; i < this.length; ++i) {\n    if (predicate(this[i])) {\n      this[this.length - 1] = this[i];\n      this.pop();\n    }\n  }\n};","map":{"version":3,"sources":["/Users/torkildjurhuus/Code/SheepJumper/src/CollisionManager/CollisionManager.js"],"names":["CollisionManger","gameObjects","undefined","add","collisionZone","i","push","remove","number","handleCollisions","collisions","length","obj1","j","obj2","collisionDetected","collision","has","object","props","parent","delete","gameObj1","gameObj2","onCollisionEnd","forEach","element","idx","handleCollision","Number","position1","position","plus","offset","position2","bottomRight1","dimensions","bottomRight2","x","y","_instance","Array","prototype","filterInPlace","predicate","pop"],"mappings":"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","sourcesContent":["export default class CollisionManger {\n  static _instance = null;\n\n  static get instance() {\n    if (CollisionManger._instance === null)\n      CollisionManger._instance = new CollisionManger();\n    return CollisionManger._instance;\n  }\n\n  gameObjects = [undefined];\n\n  add = collisionZone => {\n    let i = -1;\n    while (this.gameObjects[++i] !== undefined) {\n      this.gameObjects[i] = collisionZone;\n      return i;\n    }\n    return this.gameObjects.push(collisionZone) - 1;\n  };\n\n  remove = number => (this.gameObjects[number] = undefined);\n\n  collisionDetected(obj1, obj2) {\n    const position1 = obj1.position.plus(obj1.offset);\n    const position2 = obj2.position.plus(obj2.offset);\n    const bottomRight1 = position1.plus(obj1.dimensions);\n    const bottomRight2 = position2.plus(obj2.dimensions);\n    return (\n      position1.x < bottomRight2.x &&\n      bottomRight1.x > position2.x &&\n      position1.y < bottomRight2.y &&\n      bottomRight1.y > position2.y\n    );\n  }\n\n  handleCollisions = () => {\n    const collisions = [];\n\n    for (let i = 0, length = this.gameObjects.length; i < length; ++i) {\n      const obj1 = this.gameObjects[i];\n      if (!obj1) continue;\n      for (let j = i + 1; j < length; ++j) {\n        const obj2 = this.gameObjects[j];\n        if (!obj2) continue;\n        if (this.collisionDetected(obj1, obj2)) {\n          if (obj1.collision.has(obj2)) continue;\n\n          collisions.push([\n            {\n              object: obj1.props.parent,\n              collisionZone: obj2\n            },\n            {\n              object: obj2.props.parent,\n              collisionZone: obj1\n            }\n          ]);\n          obj1.collision.add(obj2);\n        } else {\n          if (obj1.collision.delete(obj2)) {\n            const gameObj1 = obj1.props.parent;\n            const gameObj2 = obj2.props.parent;\n\n            gameObj1.onCollisionEnd &&\n              gameObj1.onCollisionEnd({\n                object: gameObj2,\n                collisionZone: obj2\n              });\n            gameObj2.onCollisionEnd &&\n              gameObj2.onCollisionEnd({\n                object: gameObj1,\n                collisionZone: obj1\n              });\n          }\n        }\n      }\n    }\n    for (const collision of collisions) {\n      collision.forEach((element, idx) => {\n        const { object } = element;\n        object.handleCollision &&\n          object.handleCollision(collision[Number(!idx)]);\n      });\n    }\n  };\n}\n\n// eslint-disable-next-line no-extend-native\nArray.prototype.filterInPlace = function(predicate) {\n  for (let i = 0; i < this.length; ++i) {\n    if (predicate(this[i])) {\n      this[this.length - 1] = this[i];\n      this.pop();\n    }\n  }\n};\n"]},"metadata":{},"sourceType":"module"}